# OIDC-Compatible Authentication Microservice

A production-ready authentication and identity provider built using FastAPI, implementing OAuth 2.0, OpenID Connect (OIDC), JWT (RS256), JWKS, refresh tokens, key rotation, Docker, and OpenTelemetry.

This service is designed to function similarly to Auth0 / Keycloak at a smaller scale.

## ğŸš€ Features

âœ… User registration & login
âœ… Secure password hashing (bcrypt)
âœ… JWT access tokens (RS256)

âœ… Refresh token mechanism
âœ… OAuth 2.0 Authorization Code Flow
âœ… PKCE-ready architecture

âœ… OpenID Connect Discovery
âœ… JWKS endpoint for token verification
âœ… RSA key rotation with kid

âœ… Environment-based configuration
âœ… Dockerized deployment
âœ… OpenTelemetry tracing (optional)
âœ… Clean microservice architecture

## ğŸ§± Architecture Overview
Client
   â”‚
   â–¼
Auth Service (FastAPI)
   â”œâ”€â”€ OAuth 2.0 Endpoints
   â”œâ”€â”€ OIDC Discovery
   â”œâ”€â”€ JWT Issuer (RS256)
   â”œâ”€â”€ JWKS Publisher
   â”œâ”€â”€ Refresh Token Store
   â”œâ”€â”€ Key Rotation System
   â””â”€â”€ OpenTelemetry Tracing
        â”‚
        â–¼
     PostgreSQL

## ğŸ” Authentication Flow

### 1ï¸âƒ£ User Registration
POST /api/v1/register

Email & password stored securely
Password hashed using bcrypt

### 2ï¸âƒ£ Login
POST /api/v1/login

Returns:
POST /api/v1/refresh

Issues new access token
Old refresh tokens invalidated safely

### 5ï¸âƒ£ OIDC Discovery
GET /.well-known/openid-configuration

Used by:
- frontend apps
- mobile apps
- third-party services

### 6ï¸âƒ£ JWKS
GET /.well-known/jwks.json

Public RSA keys exposed for token verification.

## ğŸ”‘ Key Rotation Strategy

The service supports zero-downtime key rotation.
### 1ï¸âƒ£ Create virtual environment
APP_NAME=OIDC Auth Service
ENV=development
SECRET_KEY=super-secret-change-this-later
ALGORITHM=RS256

ACCESS_TOKEN_EXPIRE_MINUTES=15
REFRESH_TOKEN_EXPIRE_DAYS=7

DATABASE_URL=sqlite:///./auth.db
ENABLE_TELEMETRY=false
### Build image

- Password hashing using bcrypt
- RSA asymmetric JWT signing
- No shared secrets between services
- Key rotation support
- Refresh token revocation
- Strict environment configuration
- Token expiration enforced

## ğŸ“Œ Future Enhancements

- ğŸ”„ PKCE enforcement
- ğŸ‘¥ Role-based access control (RBAC)
- ğŸ§© Multi-tenant support
- ğŸ” MFA / OTP
- ğŸŒ SSO integrations
- ğŸ“ˆ Metrics dashboard